[{"type":"js","data":"/* Imports for global scope */\n\nMongoInternals = Package.mongo.MongoInternals;\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nECMAScript = Package.ecmascript.ECMAScript;\nRoles = Package['alanning:roles'].Roles;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\nmain = Package.webapp.main;\nWebAppInternals = Package.webapp.WebAppInternals;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nDDPServer = Package['ddp-server'].DDPServer;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nmeteorInstall = Package.modules.meteorInstall;\nBuffer = Package.modules.Buffer;\nprocess = Package.modules.process;\nSymbol = Package['ecmascript-runtime'].Symbol;\nMap = Package['ecmascript-runtime'].Map;\nSet = Package['ecmascript-runtime'].Set;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\nHTML = Package.htmljs.HTML;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"imports\":{\"api\":{\"messages.js\":[\"meteor/meteor\",\"meteor/mongo\",\"meteor/check\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////\n//                                                                                   //\n// imports/api/messages.js                                                           //\n//                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////\n                                                                                     //\nmodule.export({                                                                      // 1\n\tMessages: function () {                                                             // 1\n\t\treturn Messages;                                                                   // 1\n\t}                                                                                   // 1\n});                                                                                  // 1\nvar Meteor = void 0;                                                                 // 1\nmodule.importSync(\"meteor/meteor\", {                                                 // 1\n\tMeteor: function (v) {                                                              // 1\n\t\tMeteor = v;                                                                        // 1\n\t}                                                                                   // 1\n}, 0);                                                                               // 1\nvar Mongo = void 0;                                                                  // 1\nmodule.importSync(\"meteor/mongo\", {                                                  // 1\n\tMongo: function (v) {                                                               // 1\n\t\tMongo = v;                                                                         // 1\n\t}                                                                                   // 1\n}, 1);                                                                               // 1\nvar check = void 0;                                                                  // 1\nmodule.importSync(\"meteor/check\", {                                                  // 1\n\tcheck: function (v) {                                                               // 1\n\t\tcheck = v;                                                                         // 1\n\t}                                                                                   // 1\n}, 2);                                                                               // 1\nvar Messages = new Mongo.Collection('messages');                                     // 9\nMeteor.methods({                                                                     // 12\n\t'messages.insert': function (text) {                                                // 13\n\t\t// This method is used to insert new messages into the collection                  // 14\n\t\tcheck(text, String); // Make sure the user is logged in before inserting a message\n                                                                                     //\n\t\tif (!Meteor.userId()) {                                                            // 18\n\t\t\tthrow new Meteor.Error('not-authorized');                                         // 19\n\t\t}                                                                                  // 20\n                                                                                     //\n\t\tMessages.insert({                                                                  // 22\n\t\t\ttext: text,                                                                       // 23\n\t\t\tcreatedAt: new Date(),                                                            // 24\n\t\t\towner: Meteor.userId(),                                                           // 25\n\t\t\tusername: Meteor.user().username                                                  // 26\n\t\t});                                                                                // 22\n\t},                                                                                  // 28\n\t'messages.remove': function (id) {                                                  // 29\n\t\tcheck(id, String); // console.log(Meteor.userId());                                // 30\n\t\t// Roles.addUsersToRoles([Meteor.userId()],'admin', Roles.GLOBAL_GROUP);           // 32\n\t\t// console.log(Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP));  // 33\n                                                                                     //\n\t\tif (Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {            // 34\n\t\t\tMessages.remove(id);                                                              // 35\n\t\t}                                                                                  // 36\n\t}                                                                                   // 37\n});                                                                                  // 12\n///////////////////////////////////////////////////////////////////////////////////////\n\n}],\"users.js\":[\"meteor/accounts-base\",\"meteor/alanning:roles\",\"meteor/meteor\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////\n//                                                                                   //\n// imports/api/users.js                                                              //\n//                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////\n                                                                                     //\nvar Accounts = void 0;                                                               // 1\nmodule.importSync(\"meteor/accounts-base\", {                                          // 1\n\tAccounts: function (v) {                                                            // 1\n\t\tAccounts = v;                                                                      // 1\n\t}                                                                                   // 1\n}, 0);                                                                               // 1\nvar Roles = void 0;                                                                  // 1\nmodule.importSync(\"meteor/alanning:roles\", {                                         // 1\n\tRoles: function (v) {                                                               // 1\n\t\tRoles = v;                                                                         // 1\n\t}                                                                                   // 1\n}, 1);                                                                               // 1\nvar Meteor = void 0;                                                                 // 1\nmodule.importSync(\"meteor/meteor\", {                                                 // 1\n\tMeteor: function (v) {                                                              // 1\n\t\tMeteor = v;                                                                        // 1\n\t}                                                                                   // 1\n}, 2);                                                                               // 1\nMeteor.methods({                                                                     // 9\n\t'accounts.addUser': function (username, password) {                                 // 10\n\t\t// This method allows the admin to create new users                                // 11\n\t\tvar id = Accounts.createUser({                                                     // 12\n\t\t\tusername: username,                                                               // 12\n\t\t\tpassword: password                                                                // 12\n\t\t}); // It also populates the profile object for the newly created users            // 12\n                                                                                     //\n\t\tMeteor.users.update({                                                              // 15\n\t\t\t_id: id                                                                           // 15\n\t\t}, {                                                                               // 15\n\t\t\t$set: {                                                                           // 15\n\t\t\t\tprofile: {                                                                       // 15\n\t\t\t\t\tname: \"\",                                                                       // 15\n\t\t\t\t\temail: \"\",                                                                      // 15\n\t\t\t\t\tphone: \"\"                                                                       // 15\n\t\t\t\t}                                                                                // 15\n\t\t\t}                                                                                 // 15\n\t\t}); // and returns the id of the newly created user                                // 15\n                                                                                     //\n\t\treturn id;                                                                         // 18\n\t},                                                                                  // 19\n\t'roles.setRole': function (id, permission) {                                        // 20\n\t\t// Sets the roles for the newly created users                                      // 21\n\t\tRoles.addUsersToRoles([id], permission, Roles.GLOBAL_GROUP);                       // 22\n\t},                                                                                  // 23\n\t'roles.blockUser': function (id) {                                                  // 24\n\t\t// Allows the manager and admin to block a user from posting a message             // 25\n\t\tRoles.addUsersToRoles([id], 'block', 'postMessage');                               // 26\n\t},                                                                                  // 27\n\t'roles.unblockUser': function (id) {                                                // 28\n\t\t// Allows the manager and admin to unblock a user                                  // 29\n\t\tRoles.removeUsersFromRoles([id], 'block', 'postMessage');                          // 30\n\t},                                                                                  // 31\n\t'user.removeUser': function (id) {                                                  // 32\n\t\t// This method removes the user whose userId has been passed as argument           // 33\n\t\tMeteor.users.remove({                                                              // 34\n\t\t\t_id: id                                                                           // 34\n\t\t});                                                                                // 34\n\t},                                                                                  // 35\n\t'user.updateUser': function (username, name, email, phone) {                        // 36\n\t\t// This method updates the profile object of a user.                               // 37\n\t\t// This operation can be called by only the admin and managers                     // 38\n\t\tif (username === \"root\") {                                                         // 39\n\t\t\t// Check if the user is root. If yes then don't update profile                    // 40\n\t\t\treturn \"Admin details can't be changed.\";                                         // 41\n\t\t}                                                                                  // 42\n                                                                                     //\n\t\tMeteor.users.update({                                                              // 43\n\t\t\t\"username\": username                                                              // 43\n\t\t}, {                                                                               // 43\n\t\t\t$set: {                                                                           // 43\n\t\t\t\t\"profile\": {                                                                     // 43\n\t\t\t\t\t\"name\": name,                                                                   // 43\n\t\t\t\t\t\"email\": email,                                                                 // 43\n\t\t\t\t\t\"phone\": phone                                                                  // 43\n\t\t\t\t}                                                                                // 43\n\t\t\t}                                                                                 // 43\n\t\t});                                                                                // 43\n\t\treturn true;                                                                       // 44\n\t}                                                                                   // 45\n});                                                                                  // 9\n///////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"startup\":{\"roles.js\":[\"meteor/alanning:roles\",\"meteor/meteor\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////\n//                                                                                   //\n// imports/startup/roles.js                                                          //\n//                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////\n                                                                                     //\nvar Roles = void 0;                                                                  // 1\nmodule.importSync(\"meteor/alanning:roles\", {                                         // 1\n\tRoles: function (v) {                                                               // 1\n\t\tRoles = v;                                                                         // 1\n\t}                                                                                   // 1\n}, 0);                                                                               // 1\nvar Meteor = void 0;                                                                 // 1\nmodule.importSync(\"meteor/meteor\", {                                                 // 1\n\tMeteor: function (v) {                                                              // 1\n\t\tMeteor = v;                                                                        // 1\n\t}                                                                                   // 1\n}, 1);                                                                               // 1\nMeteor.methods({                                                                     // 5\n\t'setInitialRole': function () {                                                     // 6\n\t\tif (Meteor.isServer) {                                                             // 7\n\t\t\tif (!Meteor.roles) {                                                              // 8\n\t\t\t\tconsole.log(\"Setup admin\");                                                      // 9\n\t\t\t\tRoles.addUsersToRoles([this.userId], 'admin', Roles.GLOBAL_GROUP);               // 10\n\t\t\t}                                                                                 // 11\n\t\t}                                                                                  // 12\n\t}                                                                                   // 13\n});                                                                                  // 5\n///////////////////////////////////////////////////////////////////////////////////////\n\n}]}},\"server\":{\"main.js\":[\"../imports/startup/roles.js\",\"../imports/api/messages.js\",\"../imports/api/users.js\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////\n//                                                                                   //\n// server/main.js                                                                    //\n//                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////\n                                                                                     //\nmodule.importSync(\"../imports/startup/roles.js\");                                    // 1\nmodule.importSync(\"../imports/api/messages.js\");                                     // 1\nmodule.importSync(\"../imports/api/users.js\");                                        // 1\n///////////////////////////////////////////////////////////////////////////////////////\n\n}]}},{\"extensions\":[\".js\",\".json\"]});\nrequire(\"./server/main.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["/imports/api/messages.js","/imports/api/users.js","/imports/startup/roles.js","/server/main.js"],"names":["module","export","Messages","Meteor","importSync","v","Mongo","check","Collection","methods","text","String","userId","Error","insert","createdAt","Date","owner","username","user","id","Roles","userIsInRole","GLOBAL_GROUP","remove","Accounts","password","createUser","users","update","_id","$set","profile","name","email","phone","permission","addUsersToRoles","removeUsersFromRoles","isServer","roles","console","log"],"mappings":"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","file":"/app.js","sourcesContent":["// This file contains code handling the messages collection\n\nimport { Meteor } from 'meteor/meteor';\n\nimport { Mongo } from 'meteor/mongo';\n\nimport { check } from 'meteor/check';\n\nexport const Messages = new Mongo.Collection('messages');\n\n\nMeteor.methods({\n\t'messages.insert'(text) {\n\t\t// This method is used to insert new messages into the collection\n\t\tcheck(text, String);\n\n\t\t// Make sure the user is logged in before inserting a message\n\t    if (! Meteor.userId()) {\n\t      throw new Meteor.Error('not-authorized');\n\t    }\n\n\t    Messages.insert({\n\t    \ttext,\n\t    \tcreatedAt: new Date(),\n\t    \towner: Meteor.userId(),\n\t    \tusername: Meteor.user().username,\n\t    });\n\t},\n\t'messages.remove' (id) {\n\t\tcheck(id, String);\n\t\t// console.log(Meteor.userId());\n\t\t// Roles.addUsersToRoles([Meteor.userId()],'admin', Roles.GLOBAL_GROUP);\n\t\t// console.log(Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP));\n\t\tif(Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {\n\t\t\tMessages.remove(id);\n\t\t}\n\t}\n});","// This files contains Meteor methods for handling the default user collection in Meteor\n\nimport { Accounts } from 'meteor/accounts-base';\n\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { Meteor } from 'meteor/meteor';\n\nMeteor.methods({\n\t'accounts.addUser' (username, password) {\n\t\t// This method allows the admin to create new users\n\t\tvar id = Accounts.createUser({username: username, password: password});\n\n\t\t// It also populates the profile object for the newly created users\n\t\tMeteor.users.update({_id: id}, {$set: {profile: {name: \"\", email: \"\", phone: \"\"}}});\n\n\t\t// and returns the id of the newly created user\n\t\treturn id;\n\t},\n\t'roles.setRole'(id, permission) {\n\t\t// Sets the roles for the newly created users\n\t\tRoles.addUsersToRoles([id], permission, Roles.GLOBAL_GROUP);\n\t},\n\t'roles.blockUser' (id) {\n\t\t// Allows the manager and admin to block a user from posting a message\n\t\tRoles.addUsersToRoles([id], 'block', 'postMessage');\n\t},\n\t'roles.unblockUser' (id) {\n\t\t// Allows the manager and admin to unblock a user\n\t\tRoles.removeUsersFromRoles([id], 'block', 'postMessage');\n\t},\n\t'user.removeUser' (id) {\n\t\t// This method removes the user whose userId has been passed as argument\n\t\tMeteor.users.remove({_id: id});\n\t},\n\t'user.updateUser' (username, name, email, phone) {\n\t\t// This method updates the profile object of a user.\n\t\t// This operation can be called by only the admin and managers\n\t\tif(username === \"root\") {\n\t\t\t// Check if the user is root. If yes then don't update profile\n\t\t\treturn \"Admin details can't be changed.\";\n\t\t}\n\t\tMeteor.users.update({\"username\": username}, {$set: { \"profile\": {\"name\": name, \"email\": email, \"phone\": phone}}});\n\t\treturn true;\n\t}\n});","import { Roles } from 'meteor/alanning:roles';\n\nimport { Meteor } from 'meteor/meteor';\n\nMeteor.methods({\n\t'setInitialRole'() {\n\t\tif(Meteor.isServer) {\n\t\t\tif(!Meteor.roles) {\n\t\t\t\tconsole.log(\"Setup admin\");\n\t\t\t\tRoles.addUsersToRoles([this.userId], 'admin', Roles.GLOBAL_GROUP);\n\t\t\t}\n\t\t}\n\t}\n});","// Import important modules\n\nimport '../imports/startup/roles.js';\nimport '../imports/api/messages.js';\nimport '../imports/api/users.js';"]}}]