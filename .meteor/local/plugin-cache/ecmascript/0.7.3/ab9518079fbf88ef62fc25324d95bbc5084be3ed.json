{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/accounts-base","imported":["Accounts"],"specifiers":[{"kind":"named","imported":"Accounts","local":"Accounts"}]},{"source":"meteor/alanning:roles","imported":["Roles"],"specifiers":[{"kind":"named","imported":"Roles","local":"Roles"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/api/users.js","filenameRelative":"/imports/api/users.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/api/users.js.map","sourceFileName":"/imports/api/users.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"users"},"ignored":false,"code":"var Accounts = void 0;\nmodule.importSync(\"meteor/accounts-base\", {\n\tAccounts: function (v) {\n\t\tAccounts = v;\n\t}\n}, 0);\nvar Roles = void 0;\nmodule.importSync(\"meteor/alanning:roles\", {\n\tRoles: function (v) {\n\t\tRoles = v;\n\t}\n}, 1);\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n\tMeteor: function (v) {\n\t\tMeteor = v;\n\t}\n}, 2);\nMeteor.methods({\n\t'accounts.addUser': function (username, password) {\n\t\t// This method allows the admin to create new users\n\t\tvar id = Accounts.createUser({\n\t\t\tusername: username,\n\t\t\tpassword: password\n\t\t}); // It also populates the profile object for the newly created users\n\n\t\tMeteor.users.update({\n\t\t\t_id: id\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\tprofile: {\n\t\t\t\t\tname: \"\",\n\t\t\t\t\temail: \"\",\n\t\t\t\t\tphone: \"\"\n\t\t\t\t}\n\t\t\t}\n\t\t}); // and returns the id of the newly created user\n\n\t\treturn id;\n\t},\n\t'roles.setRole': function (id, permission) {\n\t\t// Sets the roles for the newly created users\n\t\tRoles.addUsersToRoles([id], permission, Roles.GLOBAL_GROUP);\n\t},\n\t'roles.blockUser': function (id) {\n\t\t// Allows the manager and admin to block a user from posting a message\n\t\tRoles.addUsersToRoles([id], 'block', 'postMessage');\n\t},\n\t'roles.unblockUser': function (id) {\n\t\t// Allows the manager and admin to unblock a user\n\t\tRoles.removeUsersFromRoles([id], 'block', 'postMessage');\n\t},\n\t'user.removeUser': function (id) {\n\t\t// This method removes the user whose userId has been passed as argument\n\t\tMeteor.users.remove({\n\t\t\t_id: id\n\t\t});\n\t},\n\t'user.updateUser': function (username, name, email, phone) {\n\t\t// This method updates the profile object of a user.\n\t\t// This operation can be called by only the admin and managers\n\t\tif (username === \"root\") {\n\t\t\t// Check if the user is root. If yes then don't update profile\n\t\t\treturn \"Admin details can't be changed.\";\n\t\t}\n\n\t\tMeteor.users.update({\n\t\t\t\"username\": username\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\t\"profile\": {\n\t\t\t\t\t\"name\": name,\n\t\t\t\t\t\"email\": email,\n\t\t\t\t\t\"phone\": phone\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn true;\n\t}\n});","map":{"version":3,"sources":["/imports/api/users.js"],"names":["Accounts","module","importSync","v","Roles","Meteor","methods","username","password","id","createUser","users","update","_id","$set","profile","name","email","phone","permission","addUsersToRoles","GLOBAL_GROUP","removeUsersFromRoles","remove"],"mappings":"AAAA,IAAIA,iBAAJ;AAAaC,OAAOC,UAAP,CAAkB,sBAAlB,EAAyC;AAACF,WAAS,UAASG,CAAT,EAAW;AAACH,aAASG,CAAT;AAAW;AAAjC,CAAzC,EAA4E,CAA5E;AAA+E,IAAIC,cAAJ;AAAUH,OAAOC,UAAP,CAAkB,uBAAlB,EAA0C;AAACE,QAAM,UAASD,CAAT,EAAW;AAACC,UAAMD,CAAN;AAAQ;AAA3B,CAA1C,EAAuE,CAAvE;AAA0E,IAAIE,eAAJ;AAAWJ,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACG,SAAO,UAASF,CAAT,EAAW;AAACE,WAAOF,CAAP;AAAS;AAA7B,CAAlC,EAAiE,CAAjE;AAQ3LE,OAAOC,OAAP,CAAe;AACd,mBADc,YACMC,QADN,EACgBC,QADhB,EAC0B;AACvC;AACA,MAAIC,KAAKT,SAASU,UAAT,CAAoB;AAACH,aAAUA,QAAX;AAAqBC,aAAUA;AAA/B,GAApB,CAAT,CAFuC,CAIvC;;AACAH,SAAOM,KAAP,CAAaC,MAAb,CAAoB;AAACC,QAAKJ;AAAN,GAApB,EAA+B;AAACK,SAAM;AAACC,aAAS;AAACC,WAAM,EAAP;AAAWC,YAAO,EAAlB;AAAsBC,YAAO;AAA7B;AAAV;AAAP,GAA/B,EALuC,CAOvC;;AACA,SAAOT,EAAP;AACA,EAVa;AAWd,gBAXc,YAWEA,EAXF,EAWMU,UAXN,EAWkB;AAC/B;AACAf,QAAMgB,eAAN,CAAsB,CAACX,EAAD,CAAtB,EAA4BU,UAA5B,EAAwCf,MAAMiB,YAA9C;AACA,EAda;AAed,kBAfc,YAeKZ,EAfL,EAeS;AACtB;AACAL,QAAMgB,eAAN,CAAsB,CAACX,EAAD,CAAtB,EAA4B,OAA5B,EAAqC,aAArC;AACA,EAlBa;AAmBd,oBAnBc,YAmBOA,EAnBP,EAmBW;AACxB;AACAL,QAAMkB,oBAAN,CAA2B,CAACb,EAAD,CAA3B,EAAiC,OAAjC,EAA0C,aAA1C;AACA,EAtBa;AAuBd,kBAvBc,YAuBKA,EAvBL,EAuBS;AACtB;AACAJ,SAAOM,KAAP,CAAaY,MAAb,CAAoB;AAACV,QAAKJ;AAAN,GAApB;AACA,EA1Ba;AA2Bd,kBA3Bc,YA2BKF,QA3BL,EA2BeS,IA3Bf,EA2BqBC,KA3BrB,EA2B4BC,KA3B5B,EA2BmC;AAChD;AACA;AACA,MAAGX,aAAa,MAAhB,EAAwB;AACvB;AACA,UAAO,iCAAP;AACA;;AACDF,SAAOM,KAAP,CAAaC,MAAb,CAAoB;AAAC,eAAYL;AAAb,GAApB,EAA4C;AAACO,SAAM;AAAE,eAAW;AAAC,aAAQE,IAAT;AAAe,cAASC,KAAxB;AAA+B,cAASC;AAAxC;AAAb;AAAP,GAA5C;AACA,SAAO,IAAP;AACA;AApCa,CAAf","file":"/imports/api/users.js.map","sourcesContent":["// This files contains Meteor methods for handling the default user collection in Meteor\n\nimport { Accounts } from 'meteor/accounts-base';\n\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { Meteor } from 'meteor/meteor';\n\nMeteor.methods({\n\t'accounts.addUser' (username, password) {\n\t\t// This method allows the admin to create new users\n\t\tvar id = Accounts.createUser({username: username, password: password});\n\n\t\t// It also populates the profile object for the newly created users\n\t\tMeteor.users.update({_id: id}, {$set: {profile: {name: \"\", email: \"\", phone: \"\"}}});\n\n\t\t// and returns the id of the newly created user\n\t\treturn id;\n\t},\n\t'roles.setRole'(id, permission) {\n\t\t// Sets the roles for the newly created users\n\t\tRoles.addUsersToRoles([id], permission, Roles.GLOBAL_GROUP);\n\t},\n\t'roles.blockUser' (id) {\n\t\t// Allows the manager and admin to block a user from posting a message\n\t\tRoles.addUsersToRoles([id], 'block', 'postMessage');\n\t},\n\t'roles.unblockUser' (id) {\n\t\t// Allows the manager and admin to unblock a user\n\t\tRoles.removeUsersFromRoles([id], 'block', 'postMessage');\n\t},\n\t'user.removeUser' (id) {\n\t\t// This method removes the user whose userId has been passed as argument\n\t\tMeteor.users.remove({_id: id});\n\t},\n\t'user.updateUser' (username, name, email, phone) {\n\t\t// This method updates the profile object of a user.\n\t\t// This operation can be called by only the admin and managers\n\t\tif(username === \"root\") {\n\t\t\t// Check if the user is root. If yes then don't update profile\n\t\t\treturn \"Admin details can't be changed.\";\n\t\t}\n\t\tMeteor.users.update({\"username\": username}, {$set: { \"profile\": {\"name\": name, \"email\": email, \"phone\": phone}}});\n\t\treturn true;\n\t}\n});"]},"hash":"ab9518079fbf88ef62fc25324d95bbc5084be3ed"}
